<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trái cây bốn mùa - Giỏ hàng</title>
    <link rel="stylesheet" href="/asset/css/style.css">

</head>

<body>
    <!-- header -->
    <nav class="navbar navbar-expand-md navbar-dark sticky-top bg-dark">
        <div class="container">
            <div class="row w-100">
                <div class="col-3 col-md-1">
                    <img class="navbar-brand w-100" src="/asset/img/logo_4sf.png">
                </div>
                <!-- Thanh điều hướng (Navbar) trên điện thoại -->
                <div class="col-8 col-md-7 d-flex align-items-center justify-content-end d-md-none">
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false"
                        aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
                <div class="col-1 col-md-7 d-flex align-items-center justify-content-end d-md-none">
                    <button class="navbar-toggler d-md-none" type="button" data-bs-toggle="collapse"
                        data-bs-target="#cartUserCollapse" aria-controls="cartUserCollapse" aria-expanded="false"
                        aria-label="Toggle cart and user">
                        <i class="fa-solid fa-user"></i>
                    </button>
                </div>

                <div class="col-12 col-md-5 d-flex align-items-center">
                    <div class="navbar-collapse collapse" id="navbarCollapse">
                        <ul class="navbar-nav mr-auto justify-content-between ml-auto w-100">
                            <li class="nav-item active">
                                <a class="nav-link" href="#">Trang chủ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="gioithieu.html">Giới thiệu</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="sanpham.html">Sản phẩm</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="lienhe.html">Liên hệ</a>
                            </li>

                        </ul>

                    </div>
                </div>

                <!-- Form tìm kiếm -->
                <div class="col-12 col-md-3 d-flex align-items-center justify-content-center">

                </div>
                <!-- Giỏ hàng và đăng nhập -->
                <div class="col-12 col-md-3 d-flex align-items-center justify-content-end ms-auto d-none d-md-block">
                    <ul class="navbar-nav ms-auto d-flex w-100 p-0 m-0">
                        <li class="nav-item d-flex flex-grow-1 text-nowrap w-25">
                            <a class="nav-link w-50" href="" id="cartLink">Giỏ hàng <i
                                    class="fa-sharp fa-solid fa-cart-shopping"></i>
                            </a>
                        </li>

                        <li class="nav-item d-flex flex-grow-1 text-nowrap w-25" id="userNavItem">
                            <a class="nav-link w-50" href="/dangnhap.html" id="userNavLink"> Đăng nhập <i
                                    class="fa-solid fa-user"></i></a>
                        </li>
                    </ul>
                </div>
                <!-- Lớp phủ -->

            </div>

        </div>
    </nav>
    <!-- end header -->

    <body onload="loadCart()">
        <div class="container mt-5 bg-light">
            <h2 class="mb-4"><i class="fa-solid fa-cart-shopping"></i> Giỏ hàng của bạn</h2>
            <div id="cart-container"></div>
            <a href="sanpham.html" class="btn btn-outline-secondary">
                <i style="margin-top: 5px; margin-left: 5px;" class="fa-solid fa-arrow-left"></i> Tiếp tục mua hàng
            </a>
            <div class="text-end mt-3">
                <h5>Tổng cộng: <span id="total-price" class="text-danger fw-bold">0 VNĐ</span></h5>

                <button id="checkoutBtn" style="height: 40px; width: 235px; font-weight: bold;" type="button"
                    class="btn btn-warning">THANH TOÁN</button>
            </div>
        </div>
    </body>

    <footer class="mt-auto py-3">
        <div class="p-3"></div>
        <hr>
        <div class="p-5"></div>
        <div class="container">
            <div class="row">
                <div class="col-md-3 d-none d-md-block">
                    <div><b>Bản quyền của Công ty TNHH Morning Fruit</b></div>
                    <div>
                        Giấy chứng nhận Đăng ký Kinh doanh số 03164646 do Sở Kế hoạch và Đầu tư Tỉnh Hậu Giang cấp ngày
                        02/01/2025. </div>
                </div>

                <div class="col-md-3">
                    <div><b>Địa chỉ : </b>Xã Hòa An, huyện Long Mỹ, tỉnh Hậu Giang</div>
                    <div><b>Số điện thoại : </b>0326754284</div>
                    <div><b>Emai : </b>traicay@gmail.com</div>
                </div>

                <div class="col-md-3 d-none d-md-block">
                    <div><b>Hổ trợ khách hàng</b></div>
                    <div>
                        <ul>
                            <li>Chính sách kiểm hàng</li>
                            <li>Chính sách bảo hành</li>
                            <li>Chính sách giao hàng</li>
                            <li>Chính sách thanh toán</li>
                            <li>Hướng dẫn mua hàng Online</li>
                            <li>Kiến thức trái cây</li>
                            <li>Liên hệ</li>

                        </ul>
                    </div>
                </div>
                <div class="col-md-3">
                    <div><b>Chăm sóc khách hàng</b></div>
                    <div>
                        <b>Số điện thoại : </b>0326754284
                    </div>
                    <div>
                        <b>Email : </b>traicay@gmail.com
                    </div>
                    <div><b>Các trang mạng xã hội khác</b></div>
                    <div>
                        <a href="/">
                            <i class="fa-brands fa-facebook p-3 fs-3"></i> </a>
                        <a href="/">
                            <i class="fa-brands fa-square-instagram p-3 fs-3"></i></a>
                        <a href="/">
                            <i class="fa-brands fa-square-github p-3 fs-3"></i></a>
                    </div>
                </div>

            </div>
    </footer>
    <hr>
    <div class="text-center fw-bold" style="text-decoration: none;">
        Copyright &copy 2025 - Nhóm 2 lập trình web
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const currentUser = JSON.parse(localStorage.getItem("currentUser"));
            const userNavLink = document.getElementById("userNavLink");

            if (currentUser && userNavLink) {
                userNavLink.innerHTML = `&nbsp; Chào, ${currentUser.userFullName} <i class="fa-solid fa-user"></i>`;
                userNavLink.href = "#";
            }
        });

        function loadCart() {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            const container = document.getElementById("cart-container");
            const totalEl = document.getElementById("total-price");
            let total = 0;
            container.innerHTML = "";

            if (cart.length === 0) {
                container.innerHTML = "<p>Giỏ hàng của bạn đang trống.</p>";
                return;
            }

            cart.forEach((item, index) => {
                const price = parseInt(item.giadagiam.replace(/\D/g, ""));
                const itemTotal = price * item.soluong;
                total += itemTotal;

                const row = `
                <div class="row mb-4 align-items-center border-bottom pb-3">
                    <div class="col-md-2 col-2">
                        <img src="${item.hinh}" class="img-fluid rounded" style="max-height: 100px;">
                    </div>
                    <div class="col-md-4 col-4">
                        <h5>${item.tensp}</h5>
                        <p class="text-muted">${item.giadagiam}</p>
                    </div>
                    <div class="col-md-4 col-4">
                        <div class="d-flex align-items-center">
                            <button class="btn btn-outline-secondary btn-sm" onclick="changeQuantity(${index}, -1)">-</button>
                            <input type="number" value="${item.soluong}" min="1" class="form-control mx-2 text-center" style="width: 40px; padding: 4px" onchange="updateQuantity(${index}, this.value)">
                            <button class="btn btn-outline-secondary btn-sm" onclick="changeQuantity(${index}, 1)">+</button>
                        </div>
                    </div>
                    <div class="col-md-2 col-2">
                        <button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})">Xóa</button>
                    </div>
                </div>
            `;
                container.innerHTML += row;
            });

            totalEl.innerText = total.toLocaleString("vi-VN") + " VNĐ";
        }

        function changeQuantity(index, delta) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart[index].soluong += delta;
            if (cart[index].soluong < 1) cart[index].soluong = 1;
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
        }

        function updateQuantity(index, quantity) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart[index].soluong = parseInt(quantity);
            if (isNaN(cart[index].soluong) || cart[index].soluong < 1) cart[index].soluong = 1;
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
        }

        function removeFromCart(index) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            cart.splice(index, 1);
            localStorage.setItem("cart", JSON.stringify(cart));
            loadCart();
        }
        document.getElementById('checkoutBtn').addEventListener('click', function () {
            // Kiểm tra nếu giỏ hàng có sản phẩm
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            if (cart.length === 0) {
                alert("Giỏ hàng của bạn đang trống. Vui lòng thêm sản phẩm trước khi thanh toán.");
            } else {
                // Chuyển hướng tới trang thanh toán
                window.location.href = 'thanhtoan.html';  // Thay bằng đường dẫn thực tế của trang thanh toán
            }
        });

    </script>

    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/admin/asset/js/logout.js"></script>
</body>

</html>